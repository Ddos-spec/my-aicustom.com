---
import Layout from '../../layouts/Layout.astro';
import { blogPosts, getRelatedArticles, findPostBySlug } from '../../data/blogPosts';

export function getStaticPaths() {
  return blogPosts.map((post) => ({
    params: { slug: post.slug },
  }));
}

const { slug } = Astro.params;
const post = findPostBySlug(slug as string);

if (!post) {
  return Astro.redirect('/404');
}

const formattedDate = new Date(post.publishDate).toLocaleDateString('id-ID', {
  day: '2-digit',
  month: 'long',
  year: 'numeric',
});

const relatedPosts = getRelatedArticles(slug as string);

const blogHref = (entrySlug: string) => `/blog/${entrySlug}/`;
---
<Layout title={`${post.title} - my-aicustom.com`}>
  <section class="bg-white py-16 dark:bg-slate-950">
    <div class="mx-auto max-w-5xl px-6">
      <span class="inline-flex items-center rounded-full border border-slate-200 px-4 py-1 text-xs font-semibold uppercase tracking-[0.35em] text-slate-500 dark:border-slate-700 dark:text-slate-300">{post.categoryLabel}</span>
      <h1 class="mt-6 text-4xl font-semibold leading-tight text-slate-900 dark:text-white sm:text-5xl">{post.title}</h1>
      <div class="mt-6 flex flex-wrap items-center gap-4 text-sm font-semibold uppercase tracking-[0.35em] text-slate-500">
        <span>{formattedDate}</span>
        <span class="hidden h-1 w-1 rounded-full bg-slate-400 sm:inline"></span>
        <span>{post.readTime}</span>
        <span class="hidden h-1 w-1 rounded-full bg-slate-400 sm:inline"></span>
        <span>Oleh {post.author}</span>
      </div>
    </div>
    <div class="mx-auto mt-10 max-w-6xl px-6">
      <img
        src={post.heroImage}
        alt={post.title}
        class="h-full w-full rounded-[2.75rem] object-cover shadow-[0_35px_120px_-50px_rgba(15,23,42,0.65)]"
        loading="lazy"
      />
    </div>
  </section>

  <section class="bg-white py-16 dark:bg-slate-950">
    <div class="mx-auto max-w-4xl px-6">
      <article class="prose prose-lg mx-auto dark:prose-invert">
        <div set:html={post.content} />
      </article>
